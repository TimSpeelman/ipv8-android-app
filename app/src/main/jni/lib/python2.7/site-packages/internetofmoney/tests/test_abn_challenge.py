from internetofmoney.tests.test_base import BaseTestCase
from internetofmoney.utils.abnchallenge import ABNChallengeParser


class TestABNChallenge(BaseTestCase):
    """
    This class contains tests for the ABN challenge class
    """

    def test_abn_challenge_string(self):
        """
        Test parsing and reconstructing of an ABN challenge string
        """
        abn_dict = {2: '1', 4: '2'}
        encoded_str = ABNChallengeParser.construct_hex_string_from_dict(abn_dict)
        self.assertEqual(encoded_str, '0200013104000132000000')

        decoded_dict = ABNChallengeParser.parse_challenge_hex_string(encoded_str)
        self.assertDictEqual(abn_dict, decoded_dict)
