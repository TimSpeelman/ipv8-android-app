from internetofmoney.tests.test_base import SessionTestCase
from internetofmoney.utils.exceptions import WrongPasswordException


class TestSession(SessionTestCase):
    """
    This class contains tests to test the Session.
    """

    def test_unlock(self):
        """
        Test unlocking a session with a given password
        """
        self.assertRaises(RuntimeError, self.session.unlock, 'abcd')

        self.session.set_password('abcde')
        self.assertRaises(WrongPasswordException, self.session.unlock, 'abcd')
        self.assertTrue(self.session.is_locked)
        self.session.unlock('abcde')
        self.assertFalse(self.session.is_locked)
