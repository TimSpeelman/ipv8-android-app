import os

from internetofmoney.tests.test_base import BaseTestCase
from internetofmoney.utils.ingkeypair import INGKeyPair


class TestINGKeyPair(BaseTestCase):
    """
    This class contains tests for the ING key pair
    """

    def test_encrypt_decrypt(self):
        """
        Test encryption/decryption of some text.
        """
        key_pair = INGKeyPair(self.temp_dir)
        self.assertTrue(os.path.exists(os.path.join(self.temp_dir, "ing_public_key.key")))
        self.assertTrue(os.path.exists(os.path.join(self.temp_dir, "ing_private_key.key")))

        encrypted = key_pair.encrypt("test")
        self.assertTrue(encrypted)
        self.assertEqual(key_pair.decrypt(encrypted), "test")
